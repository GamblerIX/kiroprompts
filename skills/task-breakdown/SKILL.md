---
name: task-breakdown
description: 将技术设计转化为可操作的、顺序的实施任务。创建清晰的编码任务，实现增量进展，尊重依赖关系，并为系统化功能开发提供路线图。
license: MIT
compatibility: Claude Code, Cursor, VS Code, Windsurf
metadata:
  category: methodology
  complexity: intermediate
  author: Kiro Team
  version: "1.0.0"
---

# 任务分解 (Task Breakdown)

将设计转化为可操作的实施计划。此技能教授如何创建结构良好的任务列表，从而实现高效、系统化的开发。

## 何时使用此技能

在以下情况下使用任务分解：
- 设计阶段已完成并获批准
- 准备开始实施
- 需要协调开发人员之间的工作
- 想要跟踪增量进展
- 规划冲刺或工作分配

## 任务结构

### 两级层级

```markdown
- [ ] 1. [史诗/主要组件]
- [ ] 1.1 [具体实施任务]
  - [实施细节]
  - [要创建的文件/组件]
  - _需求：[需求引用]_
- [ ] 1.2 [下一个具体任务]
  - [细节]
  - _需求：[引用]_

- [ ] 2. [下一个史诗/主要组件]
- [ ] 2.1 [具体任务]
```

### 任务规范要素

每个任务应包含：
1. **明确的目标：** 具体要编写/修改什么代码
2. **实施细节：** 文件、组件、函数
3. **需求引用：** 此任务实现了哪些需求
4. **完成标准：** 如何知道任务已完成

## 分步流程

### 第一步：分析设计组件

识别所有实施需求：
- 数据模型和验证
- 服务和业务逻辑
- API 端点和处理程序
- UI 组件
- 每层的测试
- 集成点

### 第二步：识别依赖关系

映射需要先构建的内容：
- **技术依赖：** 代码依赖（模型在服务之前）
- **逻辑依赖：** 功能依赖（登录在个人资料之前）
- **数据依赖：** 必须先存在的数据

### 第三步：任务排序

任务排序旨在：
- 尊重依赖关系
- 启用早期验证
- 允许增量测试
- 最小化任务间的阻塞

### 第四步：编写任务描述

对于每个任务，指定：
```markdown
- [ ] X.Y [任务标题]
  - [具体实施内容]
  - [要创建/修改的文件]
  - [关键功能]
  - [要编写的测试]
  - _需求：[Req-1, Req-2]_
```

## 排序策略

### 策略 1：基础优先

在功能之前构建核心基础设施。

```markdown
1. 项目设置和核心接口
2. 数据模型和验证
3. 数据访问层
4. 业务逻辑服务
5. API 端点
6. 集成和连接
```

**最适合：** 新项目，复杂系统

### 策略 2：功能切片（垂直）

端到端构建完整功能。

```markdown
1. 用户注册（完整流程）
2. 用户认证（完整流程）
3. 用户个人资料管理（完整流程）
4. 高级功能
```

**最适合：** MVP 开发，早期验证

### 策略 3：风险优先

尽早处理不确定的领域。

```markdown
1. 最复杂/不确定的组件
2. 外部集成
3. 核心业务逻辑
4. 用户界面
5. 润色和优化
```

**最适合：** 高不确定性，概念验证

### 策略 4：混合（推荐）

务实地结合各种方法。

```markdown
1. 最小基础（核心接口）
2. 高风险/高价值功能切片
3. 根据需要扩展基础
4. 额外的功能切片
5. 集成和润色
```

## 任务类别

### 基础任务
```markdown
- [ ] 1. 设置项目基础
- [ ] 1.1 创建项目结构和接口
  - 设置目录结构
  - 为核心类型定义 TypeScript 接口
  - 配置测试框架
  - _需求：1.1_
```

### 数据层任务
```markdown
- [ ] 2. 实施数据层
- [ ] 2.1 创建核心数据模型
  - 实施带验证的 User 模型
  - 添加数据库迁移
  - 为验证编写单元测试
  - _需求：2.1, 2.2_
```

### 业务逻辑任务
```markdown
- [ ] 3. 实施业务逻辑
- [ ] 3.1 创建认证服务
  - 实施注册逻辑
  - 添加密码哈希
  - 创建会话管理
  - 编写单元测试
  - _需求：1.2, 4.1_
```

### API 任务
```markdown
- [ ] 4. 实施 API 层
- [ ] 4.1 创建用户端点
  - 实施 POST /users 端点
  - 添加请求验证
  - 编写集成测试
  - _需求：1.2, 2.3_
```

### 集成任务
```markdown
- [ ] 5. 集成和测试
- [ ] 5.1 连接组件
  - 将服务连接到 API 层
  - 实施中间件
  - 添加端到端测试
  - _需求：5.1_
```

## 编写有效任务

### 好的任务示例
```markdown
- [ ] 2.1 创建带验证的 User 模型
  - 实施包含电子邮件、密码、名称字段的 User 类
  - 添加电子邮件验证（RFC 5322 格式）
  - 添加密码验证（8+ 字符，混合大小写，数字）
  - 为有效/无效场景编写单元测试
  - _需求：1.2, 2.1_
```

### 差的任务示例
```markdown
- [ ] 2.1 构建用户相关内容
  - 让用户功能工作
  - _需求：1.2_
```

### 任务范围指南

**合适：** 2-4 小时的专注工作

**太大：**
```markdown
- [ ] 1.1 实施完整的用户管理系统
```

**太小：**
```markdown
- [ ] 1.1 在第 42 行添加分号
```

**正好：**
```markdown
- [ ] 1.1 创建带验证方法的 User 模型
```

## 依赖管理

### 依赖类型

**技术依赖：**
```markdown
- [ ] 1.1 创建数据库连接 ← 基础
- [ ] 2.1 创建 User 模型 ← 依赖于 1.1
- [ ] 3.1 创建 UserService ← 依赖于 2.1
```

**逻辑依赖：**
```markdown
- [ ] 1.1 用户注册 ← 必须首先存在
- [ ] 2.1 用户登录 ← 依赖于 1.1
- [ ] 3.1 密码重置 ← 依赖于 2.1
```

### 处理循环依赖

**问题：**
```
UserService 需要 AuthService
AuthService 需要 UserService
```

**解决方案 - 接口提取：**
```markdown
- [ ] 1.1 创建 IUserService 和 IAuthService 接口
- [ ] 1.2 使用 IAuthService 实施 UserService
- [ ] 1.3 使用 IUserService 实施 AuthService
- [ ] 1.4 连接依赖注入
```

## 完整示例

```markdown
# 实施计划：用户认证

- [ ] 1. 设置认证基础
- [ ] 1.1 创建项目结构和接口
  - 设置 auth, models, API 的目录结构
  - 定义 User, Session, AuthRequest 的 TypeScript 接口
  - 配置 Jest用于测试
  - _需求：1.1_

- [ ] 1.2 设置数据库和迁移
  - 配置数据库连接
  - 创建用户和会话表
  - 设置测试数据库
  - _需求：1.1, 2.1_

- [ ] 2. 实施核心数据模型
- [ ] 2.1 创建带验证的 User 模型
  - 实施包含电子邮件、密码、个人资料字段的 User 类
  - 添加电子邮件格式验证
  - 添加密码强度验证（8+ 字符）
  - 为所有验证规则编写单元测试
  - _需求：1.2, 2.1_

- [ ] 2.2 创建 Session 模型
  - 实施包含令牌、过期的 Session 类
  - 添加会话验证逻辑
  - 为会话管理编写单元测试
  - _需求：1.2, 4.1_

- [ ] 3. 创建认证服务
- [ ] 3.1 实施注册服务
  - 创建带注册方法的 UserService
  - 使用 bcrypt 添加密码哈希
  - 实施重复电子邮件检查
  - 为注册编写单元测试
  - _需求：1.2_

- [ ] 3.2 实施登录服务
  - 添加带密码验证的登录方法
  - 实施 JWT 令牌生成
  - 创建刷新令牌轮换
  - 为登录流程编写单元测试
  - _需求：1.2, 4.1_

- [ ] 4. 创建 API 端点
- [ ] 4.1 实施注册端点
  - 创建 POST /auth/register 端点
  - 添加请求验证中间件
  - 实施错误响应
  - 编写集成测试
  - _需求：1.2, 2.3_

- [ ] 4.2 实施登录端点
  - 创建 POST /auth/login 端点
  - 添加认证中间件
  - 实施注销功能
  - 编写集成测试
  - _需求：1.2, 4.1_

- [ ] 5. 集成和安全
- [ ] 5.1 添加安全中间件
  - 实施速率限制
  - 添加 CORS 配置
  - 创建 JWT 验证中间件
  - 编写安全测试
  - _需求：4.1, 2.3_

- [ ] 5.2 端到端测试
  - 创建完整的认证流程测试
  - 测试错误场景
  - 验证安全措施
  - _需求：1.2, 4.1_
```

## 质量检查清单

在最终确定任务之前：

**完整性：**
- [ ] 所有设计组件都有任务
- [ ] 所有需求都已解决
- [ ] 测试任务贯穿始终
- [ ] 集成任务连接组件

**清晰度：**
- [ ] 每个任务都有具体目标
- [ ] 文件/组件已指定
- [ ] 需求已引用
- [ ] 完成标准清晰

**排序：**
- [ ] 依赖关系得到尊重
- [ ] 基础优先于功能
- [ ] 核心优先于可选
- [ ] 集成在组件之后

**可行性：**
- [ ] 任务各需 2-4 小时
- [ ] 可以独立完成
- [ ] 无外部阻碍
- [ ] 复杂度逐渐增加

## 常见陷阱

1. **任务太抽象：** “实施用户管理” vs 具体行动
2. **缺少依赖：** 无法按顺序完成的任务
3. **非编码任务：** 仅包含实施活动
4. **单体任务：** 分解为 2-4 小时的增量
5. **缺少测试：** 在每个任务中包含测试

## 任务执行提示

**开始任务之前：**
1. 彻底阅读任务详情
2. 审查引用的需求
3. 检查依赖是否完成
4. 规划实施方法

**实施期间：**
1. 将任务标记为进行中
2. 边写代码边写测试
3. 持续测试
4. 边做边记录

**标记完成之前：**
1. 所有测试通过
2. 需求已验证
3. 代码已审查
4.文档已更新

## 下一步

完成任务分解后：
1. 与团队审查任务列表
2. 将任务分配给开发人员
3. 按顺序开始实施
4. 通过标记任务完成来跟踪进度
5. 如果实施揭示了差距，更新任务
