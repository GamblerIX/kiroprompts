# 提示词最佳实践

<!-- 导航元数据 -->
<!-- 提示词：最佳实践 | 级别：实用指南 | 前置条件：prompting/strategies.md -->
<!-- 相关：ai-reasoning/decision-frameworks.md, examples/troubleshooting-pitfalls.md, templates/README.md -->

**📍 您所在位置：** [主指南](../../README.md) → [提示词策略](README.md) → **最佳实践**

## 快速导航
- **学习策略：** [提示词策略](strategies.md) - 首先学习核心方法
- **使用模板：** [提示模板](templates.md) - 随时可用的模式
- **理解AI：** [决策框架](../ai-reasoning/decision-frameworks.md) - AI如何做出选择
- **解决问题：** [故障排除指南](../examples/troubleshooting-pitfalls.md) - 当提示出现问题时

---

在规范创建过程中与AI协作的有效技术，包括故障排除指导和成功交互示例。

## 核心原则

### 1. 上下文为王

**提供丰富的上下文**
- 始终包含关于您的项目、技术栈和约束的相关背景
- 参考之前的讨论和决策以保持连续性
- 解释需求背后的"为什么"，而不仅仅是"什么"

**示例 - 良好的上下文设置：**
```
我正在开发一个目前每天处理10,000名用户的React电子商务应用程序。
我们使用TypeScript、Node.js后端和PostgreSQL，并在AWS上部署。
我需要添加一个产品推荐功能，该功能与现有的用户行为跟踪系统集成，
并且应该处理我们预期的50%流量增长。
```

**示例 - 糟糕的上下文：**
```
我需要一个推荐系统。
```

### 2. 具体且明确

**使用具体示例**
- 提供具体场景而不是抽象描述
- 在讨论数据模型时包括实际数据示例
- 引用真实的用户工作流程和业务过程

**示例 - 具体请求：**
```
对于用户身份验证系统，我需要处理这些具体场景：
1. 带有电子邮件验证的新用户注册
2. 通过Google和GitHub OAuth的社交登录
3. 带有安全令牌过期（24小时）的密码重置
4. 5次失败尝试后的账户锁定，冷却时间为30分钟
5.与我们存储偏好的现有用户个人资料系统集成
```

### 3. 构架复杂请求

**分解大型请求**
- 将复杂功能划分为逻辑阶段
- 优先考虑核心功能而非锦上添花的功能
- 排序请求以逐步建立理解

**示例 - 结构良好的请求：**
```
我想为文件上传系统创建一个全面的规范。让我们从以下开始：

第一阶段：核心上传功能
- 带有进度跟踪的单文件上传
- 文件类型验证（图像、文档）
- 大小限制（最大10MB）

第二阶段：增强功能（第一阶段稳定后处理）
- 多文件上传
- 拖放界面
- 云存储集成
```

## 阶段特定最佳实践

### 需求阶段

**应该做的：**
- 从用户问题开始，而不是技术解决方案
- 一致地使用"作为[角色]，我希望[目标]，以便[利益]"格式
- 包括愉快路径和错误场景
- 指定可衡量的验收标准

**不应该做的：**
- 跳入实施细节
- 假设AI了解您的业务背景
- 创建过于宽泛或模糊的需求
- 跳过边界情况和错误处理

**成功交互示例：**
```
用户："我需要应用程序的用户身份验证。"

更好的方法："我正在为小型企业构建SaaS应用程序。
我需要的用户身份验证支持：
- 需要管理团队访问的企业所有者
- 具有不同权限级别的团队成员
- 与现有客户数据集成
- 符合SOC 2要求

主要的用户故事是：作为企业所有者，我希望控制谁可以
访问我们的公司数据，以便我能够维护安全性和合规性。"
```

### 设计阶段

**应该做的：**
- 在做出设计决策时参考具体需求
- 解释不同方法之间的权衡
- 从一开始就考虑可扩展性和可维护性
- 在设计中包含错误处理和边界情况

**不应该做的：**
- 孤立于需求进行设计
- 为假想的未来需求过度设计
- 忽略现有系统约束
- 跳过非功能需求

**成功交互示例：**
```
用户："基于我们的身份验证需求，我需要一个设计来处理
我们讨论的多租户访问控制。我们的当前系统
使用JWT令牌，我们大约有500家企业，平均
8名团队成员。性能至关重要 - 登录应在200毫秒以内。

请设计一种方法：
1. 利用我们现有的JWT基础设施
2. 扩展到我们当前的用户群
3. 支持需求2.3中基于角色的权限
4. 与我们的PostgreSQL用户数据库集成
```

### 任务阶段

**应该做的：**
- 请求增量构建的任务
- 为每个任务指定测试要求
- 询问可以独立完成的任务
- 包含集成和部署注意事项

**不应该做的：**
- 创建太大或太复杂的任务
- 跳过测试和验证步骤
- 忽略任务之间的依赖关系
- 忘记文档和清理工作

**成功交互示例：**
```
用户："请将身份验证设计分解为编码任务。
我想遵循TDD原则并能够增量部署。
每个任务应在2-4小时内完成，并包含自己的测试。

优先事项是首先让基本的登录/注销工作，然后添加
基于角色的权限。我使用Jest进行测试，并已设置
CI/CD与GitHub Actions。"
```

## 沟通技术

### 迭代优化

**在先前响应基础上构建**
```
"需求整体看起来不错。我想优化需求2.1
使其更加具体关于错误处理。而不是
'系统应该优雅地处理错误'，让我们具体说明
身份验证失败、网络不可用以及令牌过期时
会发生什么。"
```

**验证理解**
```
"在进入设计之前，让我确认我的理解：
- 我们优先考虑安全性而非便利性
- 与现有系统的集成是强制的，不是可选的
- 性能要求是固定的（登录<200毫秒）
- 我们需要同时支持Web和移动客户端
这样对吗？"
```

### 反馈整合

**具体更改请求**
```
"我对设计需要这些具体更改：
1. 用内存缓存替换Redis缓存以减少基础设施复杂性
2. 添加速率限制以防止暴力攻击（需求1.4）
3. 包含移动应用用例的会话管理
4. 指定角色存储所需的数据库模式更改"
```

**解释原因**
```
"我想将身份验证方法从OAuth更改为JWT，因为：
- 我们的团队对JWT实施有更多经验
- 减少外部依赖（不需要OAuth提供商）
- 更适合我们的离线功能移动应用要求
- 在我们当前的设置中更简单测试和调试"
```

## 故障排除常见问题

### 当响应过于通用时

**问题：** AI提供高层级的通用建议而不是具体指导。

**解决方案：** 添加更多上下文和约束。

**之前：**
```
"我应该如何为用户管理构建数据库？"
```

**之后：**
```
"我的PostgreSQL数据库用于多租户SaaS应用，有这些约束：
- 500家企业，平均8名用户
- 需要跟踪用户角色、权限和活动
- 当前用户表有id、email、created_at
- 必须与现有身份验证系统保持向后兼容
- 性能目标：用户查找<50毫秒

我应该如何扩展模式以支持基于角色的访问控制？"
```

### 当需求不断变化时

**问题：** 需求阶段的范围蔓延。

**解决方案：** 建立明确的边界和优先级。

**方法：**
```
"让我们首先建立MVP范围。对于版本1，我们必须拥有：
- [核心需求1]
- [核心需求2]
- [核心需求3]

锦上添花的功能用于未来版本：
- [增强功能1]
- [增强功能2]

请仅专注于MVP范围的需求。"
```

### 当设计变得过于复杂时

**问题：** 设计试图解决每一个可能的未来需求。

**解决方案：** 重新聚焦于当前需求和约束。

**方法：**
```
"设计变得复杂了。让我们通过仅关注
需求1.1-1.4来简化。我们可以以后再扩展它以满足需求
2.x。请修改设计：
- 处理当前用户负载（而非10倍未来增长）
- 使用我们现有的技术栈（不引入新技术）
- 解决我们需求中的具体问题（而非一般问题）"
```

### 当任务过于抽象时

**问题：** 实施任务对于实际编码来说过于高层。

**解决方案：** 请求具体的、可操作的编码步骤。

**之前：**
```
"- 实施用户身份验证系统"
```

**之后：**
```
"请将'实施用户身份验证系统'分解为具体的编码任务，例如：
- 创建具有email、password_hash、role字段的User模型
- 用bcrypt编写密码哈希实用函数
- 实现验证凭证并返回JWT的登录端点
- 创建用于验证受保护路由上JWT令牌的中间件
- 为每个组件编写单元测试"
```

## 质量验证技术

### 需求验证

**完整性检查：**
```
"请审查这些需求并识别任何差距：
- 是否涵盖所有用户类型？
- 我们是否处理所有错误场景？
- 是否指定了集成点？
- 性能要求是否可衡量？
- 范围是否明确界定？"
```

**EARS格式验证：**
```
"请检查这些验收标准是否正确遵循EARS格式：
- 它们是否以WHEN、IF、WHERE、WHILE开头？
- 系统响应是否用SHALL清楚指定？
- 条件和触发器是否具体且可测试？"
```

### 设计验证

**架构审查：**
```
"请根据我们的需求验证此设计：
- 它是否满足所有功能需求？
- 非功能需求（性能、安全性）是否得到处理？
- 组件之间的接口是否定义良好？
- 错误处理是否全面？
- 这可以有效测试吗？"
```

**技术可行性：**
```
"考虑到我们的约束（团队规模、时间线、现有系统），
这个设计现实吗？是否有任何部分看起来
过度设计或未充分指定？"
```

### 任务验证

**可操作性检查：**
```
"这些任务对于开发者来说是否足够具体？
- 它们是否指定了要创建的确切文件/组件？
- 任务之间的依赖关系是否清楚？
- 每个任务可以独立完成和测试吗？
- 它们是否增量构建到完整功能？"
```

## 高级技术

### 研究整合

**当您需要技术研究时：**
```
"在最终确定设计之前，我需要研究
多租户SaaS应用程序的身份验证
最佳实践。请帮助我识别关键研究领域：
- 基于角色访问控制的行业标准
- 常见安全漏洞和缓解措施
- JWT大规模性能优化技术
- 与现有系统的集成模式"
```

### 约束管理

**处理冲突需求：**
```
"我们有冲突的需求：用户想要单点登录（需求1.3）
但我们也需要离线功能（需求2.1）。请帮助我：
1. 分析这些方法之间的权衡
2. 建议折中解决方案
3. 推荐哪个需求应该优先及原因"
```

### 利益相关者对齐

**多角度验证：**
```
"请从不同利益相关者的角度审查这些需求：
- 开发者：使用我们的技术栈在技术上是否可行？
- 用户：它们是否有效解决真实的用户问题？
- 业务：它们是否与我们的业务目标和约束一致？
- 安全：是否存在任何安全问题或差距？"
```

---

[← 模板](templates.md) | [返回提示词指南](README.md)
